---
title: bedbaser
author:
- name: J Wokaty
  affiliation: 
  - CUNY School of Public Health
  email: jennifer.wokaty@sph.cuny.edu
package: bedbaser
output: 
  BiocStyle::html_document
vignette: >
  %\VignetteIndexEntry{bedbaser}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}  
---

```{r library, include=FALSE}
library(bedbaser)
```

bedbaser is an R client for [BEDbase](https://bedbase.org) a platform for
genomic region data, allowing users to search BED files and curate collections.
bedbaser provides convenience functions to interact with the
[BEDbase API](https://api.bedbase.org) but it also allow more direct
interaction with the API through `r Biocpkg("AnVIL")`'s `Service` class.

## Install bedbaser

Install bedbaser using `r CRANpkg("BiocManager")`.

```{r install, eval=FALSE}
if (!"BiocManager" %in% rownames(installed.packages()))
    install.packages("BiocManager")
BiocManager::install("bedbaser", dependencies=TRUE)
```

## Create a bedbaser client

bedbaser uses the `r Biocpkg("AnVIL")` Service class to create a `BEDbase`
client, which can be use to access the API directly.

```{r bedbase}
client <- BEDbase()
show(client)
```

End points can be accessed with `$` and their results can be retrieved
with `r CRANpkg("httr")`.

```{r count_bed_record_bed_count_get}
library(httr)
resp <- client$get_example_bed_record_bed_example_get()
example_bed <- content(resp)
```

bedbaser includes convenience functions prefixed with *bb_* to facilitate
finding BEDs, exploring their metadata, and download files.

## Find a BED file or BEDset

Use `bb_records()` to browse available resources in BEDbase. `bb_records()`
will display the record identifiers and names of BED files and BEDsets.
Record identifiers can be used to access a specific resource.

```{r get_records}
# limit to 10 results, 
bb_records(client, "bed")

bb_records(client, "bedset")
```

### Examine metadata

Use `bb_metadata()` to learn more about a BED or BEDset associated with
a record identifier.

```{r get_metadata}
bb_metadata(client, example_bed$record_identifier, "bed")
```

### Show BED files in BEDset

Use `bb_beds_in_bedset()` to display the record identifiers of BEDs in a
BEDset. 

```{r bb_beds_in_bedset}
bb_beds_in_bedset(client, "excluderanges")
```

### Search for a BED file by keyword

Search for BED files by keywords:

```{r search_bedbase, eval=FALSE}
# Currently not working
results <- search_bedbase("hg13", limit = 20)
```

## Download a BED file

Download a BED file by its record identifier:

```{r downloadBedFile, eval=FALSE}
# Need to rewrite function
filepath <- download_file(example_bed$record_identifier, "bytes")
```

## SessionInfo()

```{r sessionInfo}
sessionInfo()
```   
